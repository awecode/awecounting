{% extends "_base.html" %}
{% load i18n staticfiles filters %}

{% block page-title %}{% trans 'Trial Balance' %}{% endblock %}

{% block extrahead %}
    <script src="{% static 'report/js/trial_balance.js' %}"></script>
    <script src="{% static 'js/libs/knockout.mapping.js' %}"></script>
    <script>
        trial_balance_data = {{ data|jsonify }};
    </script>
{% endblock %}

{% block header-buttons %}
    {#    <a class="btn btn-success btn-raised" href="{% url 'category_add' %}">{% trans 'New' %} {% trans 'Category' %}</a>#}
{% endblock %}

{% block content %}

    {#    {{ root }}#}
    <div class="well">
        <div class="row">
            <div class="col-xs-6">{% trans 'Category' %}/{% trans 'Account' %}</div>
            <div class="col-xs-3">{% trans 'Dr' %}</div>
            <div class="col-xs-3">{% trans 'Cr' %}</div>
        </div>
        <hr/>


        <div id="nav-bar" data-bind="template: { name: 'tree-template', data: tree_data }"></div>


        <script type="text/html" id="tree-template">

            <ul data-bind="foreach: nodes">
                <li>
            <span data-bind="
                template: { name: 'node-name-template', data: $data },
                css: { 'pointer-icon': nodes().length > 0 },
                click: toggleVisibility"></span>

                    <div data-bind="template: { name: 'folder-template', data: $data }, visible: isExpanded"></div>
                </li>
            </ul>

        </script>

        <script type="text/html" id="folder-template">

            <ul data-bind="foreach: nodes">
                <li>

                    <div data-bind="template: { name: 'node-template', data: $data }"></div>

                </li>
            </ul>

        </script>

        <script type="text/html" id="node-template">

            <span data-bind="
        template: { name: 'node-name-template', data: $data },
        css: { 'pointer-icon': nodes().length > 0 },
        click: toggleVisibility"></span>

            <!-- ko if: nodes().length !== 0 -->

            <div data-bind="template: { name: 'folder-template', data: $data }, visible: isExpanded"></div>

            <!-- /ko -->

        </script>

        <script type="text/html" id="node-name-template">

            <span class="tree-item" data-bind="
    css: { 
        'fa fa-minus': isExpanded() && nodes().length > 0, 
        'fa fa-plus': !isExpanded() && nodes().length > 0,
        'fa fa-stop': nodes().length === 0 
    }
    "></span>

            <span data-bind="
    text: name, 
    attr: { 'title': description }, 
    tooltip: { delay: { show: 500, hide: 10 } }"></span>

        </script>


    </div>

{% endblock %}